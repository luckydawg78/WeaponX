# WeaponX

## Introduction

This project provides an automated red team workflow to process and act upon results generated by [ScanCannon](https://github.com/johnnyxmas/ScanCannon). The tool parses ScanCannon output, identifies services and ports across hosts, maps them to security actions, and executes follow-up testing using configured tools like Hydra, Nikto, WhatWeb, and Metasploit modules.

It is particularly useful for penetration testers or red teamers who want to streamline their recon-to-exploitation pipeline.

---

## Features

- Parses ScanCannon's `hosts_and_ports.txt` and `interesting_servers` output.
- Automatically identifies services based on port numbers and labeled files.
- Plans actions like `credential_testing` or `web_followup` per host/service.
- Executes tools like Hydra, Nikto, WhatWeb, Metasploit, and SSLScan.
- Optionally outputs a JSON summary of discovered hosts and services.

---

## Installation

1. Clone this repository:
   ```bash
   git clone https://github.com/luckydawg78/WeaponX
   cd WeaponX
   ```

2. Ensure Python 3.7+ is installed.

3. Install dependencies (if any are added later).

4. Install external tools used by the framework:
   - `hydra`
   - `nikto`
   - `whatweb`
   - `sslscan`
   - `msfconsole` (Metasploit)

5. Make sure wordlists from [SecLists](https://github.com/danielmiessler/SecLists) are present at:
   ```
   /usr/share/wordlists/seclists/Usernames/
   /usr/share/wordlists/seclists/Passwords/Common-Credentials/
   ```

---

## Usage

```bash
python3 main.py --results /path/to/scancannon/results --config config.json --dump-json output/summary.json
```

### Arguments:

- `--results`: Path to the `results/` directory generated by ScanCannon (required).
- `--config`: Path to a JSON configuration file (optional, defaults are used if omitted).

---

## Configuration

The `config.json` file defines:
- Which actions to take for each service.
- What tools to use for those actions.
- Custom command templates per tool.

### Example (`config.json`):

```json
{
  "services": {
    "ssh": {
      "actions": ["credential_testing"],
      "tools": ["hydra_ssh", "msf_ssh_login"]
    },
    "http": {
      "actions": ["web_followup"],
      "tools": ["nikto_http", "whatweb_fingerprint"]
    }
  },
  "tools": {
    "hydra_ssh": {
      "cmd": "hydra -L ... -o results/{ip}_ssh_hydra.txt ssh://{ip}:{port}"
    }
  },
  "defaults": {
    "actions": ["other"],
    "tools": []
  }
}
```

Placeholders `{ip}`, `{port}`, and `{service}` are dynamically substituted.

---

## Dependencies

- Python Standard Library:
  - `argparse`, `json`, `subprocess`, `dataclasses`, `pathlib`, `collections`
- External Tools (must be installed and in `$PATH`):
  - `hydra`
  - `nikto`
  - `whatweb`
  - `sslscan`
  - `msfconsole`

---

## Examples

Basic command:
```bash
python3 main.py --results ./results --config ./config.json
```
---

## Troubleshooting

- **No hosts found**: Ensure `results/` contains `hosts_and_ports.txt` in subdirectories.
- **Tool not found**: Make sure required tools (e.g., `hydra`, `nikto`) are installed and accessible.
- **Missing wordlists**: Check that required SecLists files exist in `/usr/share/wordlists/seclists/...`
- **Permission denied**: You might need to run the script with elevated privileges for some tools.

---

## Contributors

- Kevin Pigney
- Christian Averill

---

## License

This project is licensed under the [MIT License](LICENSE), unless otherwise specified.
